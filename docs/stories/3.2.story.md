# Story 3.2: Implement Intelligent Data Table UI

## Status
Draft

## Story
**As a** Salesperson,
**I want** to see a smart dashboard that helps me prioritize my work,
**so that** I can improve my sales performance.

## Acceptance Criteria
1. แก้ไขไฟล์ pages/dashboard.php และ assets/css/dashboard.css
2. UI ต้องแสดงผลเป็น Data Table ที่มีดีไซน์ "เรียบหรู ดูแพง" (ใช้ Font, Whitespace, และสีตาม Guideline)
3. ต้องมีคอลัมน์ "เวลาที่เหลือ" ที่แสดงผลเป็น Progress Bar ที่เปลี่ยนสีได้ (เขียว/เหลือง/แดง) ตามข้อมูล time_remaining_days จาก API
4. แถวของลูกค้าที่มี CustomerTemperature = 'HOT' หรือมี time_remaining_days < 5 จะต้องถูกไฮไลท์ให้โดดเด่น

## Tasks / Subtasks

- [ ] Task 1: วิเคราะห์ Dashboard UI ปัจจุบัน (AC: 1)
  - [ ] ตรวจสอบโครงสร้าง pages/dashboard.php ปัจจุบัน
  - [ ] วิเคราะห์ existing CSS styles ใน assets/css/dashboard.css
  - [ ] ตรวจสอบ JavaScript patterns ที่ใช้อยู่
  - [ ] ประเมิน compatibility กับ enhanced API (Story 3.1)

- [ ] Task 2: ออกแบบ Premium UI Components (AC: 2)
  - [ ] ออกแบบ "เรียบหรู ดูแพง" design system
  - [ ] เลือก Font families และ Typography scales
  - [ ] กำหนด Color palette และ Spacing guidelines
  - [ ] สร้าง CSS classes สำหรับ premium styling

- [ ] Task 3: พัฒนา Intelligent Data Table (AC: 3)
  - [ ] สร้าง Progress Bar component ด้วย CSS และ JavaScript
  - [ ] เขียน Logic สำหรับคำนวณสีของ Progress Bar (เขียว/เหลือง/แดง)
  - [ ] เพิ่มคอลัมน์ "เวลาที่เหลือ" ใน table structure
  - [ ] Integration กับ enhanced API data (time_remaining_days)

- [ ] Task 4: พัฒนา Smart Row Highlighting (AC: 4)
  - [ ] เขียน JavaScript logic สำหรับ detect HOT customers
  - [ ] เขียน JavaScript logic สำหรับ detect urgent customers (time < 5 days)
  - [ ] สร้าง CSS classes สำหรับ row highlighting
  - [ ] เพิ่ม visual indicators และ icons สำหรับ priority rows

- [ ] Task 5: Responsive Design และ Performance (AC: 1,2,3,4)
  - [ ] ทดสอบ responsive design บน mobile และ tablet
  - [ ] Optimize JavaScript performance สำหรับ large datasets
  - [ ] เพิ่ม loading states และ error handling
  - [ ] ทดสอบ cross-browser compatibility

## Dev Notes

### Previous Story Insights
**จาก Story 3.1** [Source: docs/stories/3.1.story.md]:
- API จะส่ง time_remaining_days และ CustomerTemperature แล้ว
- JSON response format พร้อมสำหรับ frontend integration
- ต้องรอ Story 3.1 เสร็จสมบูรณ์ก่อนทำ Integration

**จาก Stories 1.x, 2.x** [Source: docs/stories/*.story.md]:
- Business logic สำหรับ lead management workflow พร้อมใช้งาน
- Database schema สำหรับ tracking customers และ assignments พร้อมแล้ว

### Data Models
**Frontend Data Structure** [Source: docs/stories/3.1.story.md]:
```javascript
{
  customers: [
    {
      id: "customer_id",
      name: "customer_name", 
      phone: "customer_phone",
      status: "customer_status",
      time_remaining_days: 25,
      customer_temperature: "HOT"
    }
  ]
}
```

**Progress Bar Color Logic**:
- เขียว (Green): time_remaining_days > 10
- เหลือง (Yellow): time_remaining_days 5-10
- แดง (Red): time_remaining_days < 5

**Row Highlighting Logic**:
- Priority highlight: CustomerTemperature = 'HOT' OR time_remaining_days < 5
- Different styling levels สำหรับ different priority types

### API Specifications
- ใช้ enhanced API จาก Story 3.1
- AJAX calls เพื่อ real-time data updates
- Error handling สำหรับ API failures

### Component Specifications
**UI Components ที่ต้องพัฒนา**:

*Premium Data Table*:
- Modern typography (Google Fonts หรือ system fonts)
- Consistent spacing และ alignment
- Subtle shadows และ borders
- Clean color scheme

*Progress Bar Component*:
- Animated progress indicators
- Color-coded based on urgency
- Tooltip สำหรับ exact days remaining
- Responsive design

*Row Highlighting System*:
- Visual priority indicators
- Consistent color coding
- Clear visual hierarchy
- Accessibility considerations

### File Locations
**Primary Files**:
- แก้ไข: `pages/dashboard.php` - Main dashboard page
- แก้ไข: `assets/css/dashboard.css` - Dashboard styling
- แก้ไข: `assets/js/dashboard.js` - Dashboard JavaScript logic

**Dependencies**:
- Enhanced API จาก Story 3.1 (`api/dashboard/summary.php`)
- `assets/css/style.css` - Global styles
- `assets/js/main.js` - Global JavaScript functions

### Testing Requirements
**Testing Standards** [Source: docs/architecture.md#test-strategy]:
- Cross-browser testing (Chrome, Firefox, Safari, Edge)
- Responsive design testing (Mobile, Tablet, Desktop)
- Performance testing กับ large datasets
- Accessibility testing (WCAG guidelines)

**Test Scenarios**:
- Progress Bar: แสดงสีที่ถูกต้องตาม time_remaining_days
- Row Highlighting: ไฮไลท์ถูกต้องสำหรับ HOT customers และ urgent cases
- Responsive: UI ทำงานได้ดีบนทุก screen size
- Performance: Loading time < 2 seconds กับ 500+ customers
- Error Handling: Graceful degradation เมื่อ API ไม่ตอบสนอง

### Technical Constraints
**Design Requirements** [Source: docs/prd.md#dashboard-ui-ux-revamp]:
- "เรียบหรู ดูแพง" aesthetic ด้วย premium typography และ spacing
- Consistent กับ existing brand identity (ถ้ามี)
- Modern และ professional appearance

**Performance Requirements**:
- Page load time < 2 seconds
- Smooth animations และ interactions
- Efficient DOM manipulation สำหรับ large tables
- Minimal JavaScript bundle size

**Usability Requirements**:
- Intuitive interface สำหรับ Sales ที่ไม่มี technical background
- Clear visual hierarchy สำหรับ priority management
- Accessible design สำหรับ users with disabilities
- Mobile-friendly สำหรับ on-the-go usage

**Browser Compatibility**:
- Support modern browsers (Chrome 80+, Firefox 75+, Safari 13+, Edge 80+)
- Progressive enhancement สำหรับ older browsers
- Consistent experience across platforms

### Testing
**Test file location**: `tests/ui/dashboard/`
**Test standards**:
- UI/UX Testing สำหรับ visual components
- JavaScript Unit Testing สำหรับ table logic
- Cross-browser และ responsive testing
**Testing frameworks and patterns to use**:
- Browser testing tools (Selenium, Playwright)
- JavaScript testing frameworks (Jest, QUnit)
- CSS regression testing tools
**Specific testing requirements for this story**:
- ทดสอบ Progress Bar color logic ในทุกสถานการณ์
- ทดสอบ Row highlighting accuracy กับ different customer types
- ทดสอบ Responsive design บน multiple devices
- ทดสอบ Performance กับ large customer datasets
- ทดสอบ Accessibility compliance

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 26/07/2568 | 1.0 | Initial story creation | Scrum Master |

## Dev Agent Record
*This section is populated by the development agent during implementation*

### Agent Model Used
*To be filled by Dev Agent*

### Debug Log References  
*To be filled by Dev Agent*

### Completion Notes List
*To be filled by Dev Agent*

### File List
*To be filled by Dev Agent*

## QA Results
*Results from QA Agent QA review of the completed story implementation*